import numpy as np
import matplotlib
import pylab
from pylab import *
import matplotlib.pyplot as plt
from matplotlib.ticker import NullFormatter
from matplotlib.font_manager import FontProperties
from sklearn.neighbors import KernelDensity
from scipy.stats import gaussian_kde
from matplotlib.pyplot import figure, show
import scipy.optimize
from mpl_toolkits.axes_grid1.axes_divider import make_axes_locatable


from matplotlib import rc
from matplotlib import rcParams

rc('text', usetex=True)
rc('text.latex', preamble='\\usepackage{sfmath}')
rcParams['font.family'] = 'sans-serif'
rcParams['font.sans-serif'] = ['Arial']

matplotlib.rcParams['xtick.labelsize'] = 0
matplotlib.rcParams['ytick.labelsize'] = 0

pylab.rcParams['xtick.major.pad']='4'
pylab.rcParams['ytick.major.pad']='4'


nullfmt = NullFormatter() # no labels


fig, axes = plt.subplots(nrows=1, ncols=3, figsize=(20, 4.8))
ax0, ax1, ax2 = axes.flatten()





x = np.log10(np.array([3.15000000e+00, 3.62759718e+00, 4.17760675e+00, 4.81100776e+00, 5.54044387e+00, 6.38047572e+00, 7.34787166e+00, 8.46194237e+00, 9.74492643e+00, 1.12224342e+01, 1.29239589e+01, 1.48834656e+01, 1.71400692e+01, 1.97388148e+01, 2.27315774e+01, 2.61780971e+01, 3.01471718e+01, 3.47180302e+01, 3.99819138e+01, 4.60438976e+01, 5.30249882e+01, 6.10645389e+01, 7.03230314e+01, 8.09852794e+01, 9.32641177e+01, 1.07404651e+02, 1.23689145e+02, 1.42442665e+02, 1.64039558e+02, 1.88910933e+02, 2.17553259e+02, 2.50538282e+02, 2.88524434e+02, 3.32269975e+02, 3.82648134e+02, 4.40664537e+02, 5.07477279e+02, 5.84420046e+02, 6.73028732e+02, 7.75072104e+02, 8.92587104e+02, 1.02791951e+03, 1.18377077e+03, 1.36325190e+03, 1.56994563e+03, 1.80797789e+03, 2.08210015e+03, 2.39778433e+03, 2.76133195e+03, 3.18000000e+03] ))
y = np.array([0.03284803, 0.05031646, 0.07733293, 0.11797975, 0.17545577, 0.25052025, 0.34049484, 0.43924244, 0.53808864, 0.62737898, 0.69840582, 0.74557435, 0.76840908, 0.77223442, 0.76614015, 0.75838992, 0.7519327 , 0.7433214 , 0.72578183, 0.69382232, 0.64611968, 0.58568745, 0.51851284, 0.45184702, 0.39230906, 0.34392692, 0.30702634, 0.27885874, 0.25566732, 0.23484279, 0.21591855, 0.20003283, 0.18837375, 0.18068134, 0.17487625, 0.16809693, 0.1583052 , 0.1452128 , 0.12999956, 0.11431074, 0.0993423 , 0.08545261, 0.07232788, 0.05953226, 0.04710069, 0.0357256 , 0.02634312, 0.0194552 , 0.01477994, 0.01149849])

a = -0.4
b = 3.98





       
xpred = array([2.23552845, 2.27171358, 2.30789872, 2.34408386, 2.380269  , 2.41645413, 2.45263927, 2.48882441, 2.52500954, 2.56119468, 2.59737982, 2.63356496, 2.66975009, 2.70593523, 2.74212037, 2.77830551, 2.81449064, 2.85067578, 2.88686092, 2.92304605, 2.95923119, 2.99541633, 3.03160147, 3.0677866 , 3.10397174, 3.14015688, 3.17634202, 3.21252715, 3.24871229, 3.28489743, 3.32108256, 3.3572677 , 3.39345284, 3.42963798, 3.46582311, 3.50200825, 3.53819339, 3.57437852, 3.61056366, 3.6467488 , 3.68293394, 3.71911907, 3.75530421, 3.79148935, 3.82767449, 3.86385962, 3.90004476, 3.9362299 , 3.97241503, 4.00860017] )
ypred = array([0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.02874622, 0.03488493, 0.05249226, 0.08226219, 0.12318735, 0.16963736, 0.21800564, 0.27086463, 0.32792888, 0.38111825, 0.4207187 , 0.44449986, 0.47053395, 0.51814067, 0.58380696, 0.662695  , 0.75920838, 0.90298058, 1.10466938, 1.34799364, 1.58258395, 1.75524905, 1.84666285, 1.88322281, 1.90925865, 1.92904507, 1.88467732, 1.72609088, 1.43724898, 1.08248577, 0.73003934, 0.43657836, 0.24516933, 0.12812713, 0.08212007, 0.08212007, 0.08212007, 0.08212007, 0.08212007, 0.08212007, 0.08212007])


xobs =  np.log10(np.array([  172.        ,   186.94488381,   203.18831152,   220.84311214,   240.03191825,   260.88801784,   283.55628012,   308.19416186,   334.97280105,   364.07820564,   395.71254564,   430.09555736,   467.46606975,   508.08366334,   552.2304733 ,   600.21314922,   652.36498512,   709.04823456,   770.65662688,   837.61810214,   910.3977836 ,   989.50120857,  1075.47783991,  1168.92488267,  1270.49143239,  1380.88298376,  1500.86633111,  1631.27489466,  1773.01450953,  1927.06971787,  2094.51060754,  2276.50024512,  2474.30275473,  2689.29209877,  2922.96162168,  3176.9344229 ,  3452.97463113,  3752.99965819,  4079.09351762,  4433.52130054,  4818.74490923,  5237.44015788,  5692.5153591 ,  6187.13152547,  6724.72432636,  7309.0279525 ,  7944.10105423,  8634.35493337,  9384.58418474, 10200.        ]))
yobs = np.array([0.00998521, 0.01137504, 0.01283331, 0.0152164 , 0.01974888, 0.02807371, 0.0420053 , 0.06258075, 0.08876635, 0.11701804, 0.14259891, 0.16194413, 0.17409157, 0.18005141, 0.18122287, 0.17884297, 0.17496042, 0.17366729, 0.18132558, 0.20559267, 0.25348174, 0.32865446, 0.42894226, 0.54622461, 0.66995832, 0.79246194, 0.91174537, 1.02934566, 1.14502815, 1.25298753, 1.3428227 , 1.40458759, 1.43399888, 1.43364492, 1.40897149, 1.36221052, 1.28996299, 1.18779106, 1.05875005, 0.9180904 , 0.78875286, 0.69000796, 0.62722055, 0.58958595, 0.55687559, 0.51058303, 0.44267211, 0.35738202, 0.26656028, 0.18283086])
       


ax0.plot(x, y, color = 'navy', lw=3, label = r'mass\\ distribution\\ constraint')

ax0.legend(prop={'size':27}, loc ='upper right')


ax0.set_xlabel('log (mass)', fontsize= 35)
ax0.set_ylabel('Probability density', fontsize=35)


ax1.plot(x, a*x + b, color = 'crimson', linestyle = '--', lw=3, label = r'frequency-mass\\ scaling')

ax1.set_xlabel('log (mass)', fontsize= 35)
ax1.set_ylabel('log (frequency)', fontsize=35)

ax1.legend(prop={'size':27}, loc ='upper right')

ax2.plot(xobs, yobs, color='navy', lw=3, label = r'observed')
ax2.plot(xpred, ypred, color = 'crimson', linestyle = '--', lw=3, label = r'expected')

ax2.legend(prop={'size':27}, loc ='upper left')

xlabel('log (frequency)', fontsize= 35)
ylabel('Probability density', fontsize=35)
fig.tight_layout()

plt.savefig('acoustic1_lower.png')
